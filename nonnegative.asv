clear
load('text-mining-medline_stemmed.mat');
load('text-mining-medline.tar/MED.REL');
correctRelDocs = sparse(MED(:,1), MED(:,3), 1) == 1; % hehe

k = 50;

[W,H] = nnmf(A,k);
[Q,R] = qr(W,0);

Rinv = inv(R)

cosines = zeros(size(q, 2), size(Gk, 2));
for queryNum = 1:size(q,2)
    qHat = Rinv * Q' * q(:,queryNum);
    
    for j = 1: size(Gk, 2)
        den = normest(qk(:,queryNum)) * normest(Gk(:,j));
        cosines(queryNum, j) = qk(:,queryNum)' * Gk(:,j) / den;
    end
end
